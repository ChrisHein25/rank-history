<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Rankings Explorer</title>
  <link rel="stylesheet" href="style.css" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    /* Minimal defaults (keep or move to style.css) */
    body { font-family: system-ui, Arial, sans-serif; margin: 20px; }
    h1 { margin-bottom: 12px; }
    section { margin: 28px 0; }
    .row { display: flex; gap: 24px; align-items: flex-start; flex-wrap: wrap; }
    .card { border: 1px solid #ddd; border-radius: 8px; padding: 12px; background: #fff; }
    label { font-weight: 600; margin-right: 8px; }
    select, button { padding: 6px 8px; }
    table { border-collapse: collapse; width: 100%; }
    th, td { border: 1px solid #e6e6e6; padding: 6px 8px; text-align: center; }
    th { background: #f7f7f7; }
    .muted { color: #666; font-size: 0.9em; }
    .sidebar { min-width: 260px; max-width: 320px; }
    .flex-1 { flex: 1 1 480px; }
    .controls { display: flex; gap: 12px; flex-wrap: wrap; align-items: center; margin: 8px 0; }
    .multi { min-width: 260px; height: 120px; }
    .note { font-size: 12px; color: #555; margin-top: 4px; }
  </style>
</head>
<body>
  <h1>FBS College Football Rankings Explorer</h1>
  <p>
    Data from <a href="https://www.espn.com/college-football/rankings" target="_blank">ESPN</a>, 2004–2024 (for now)
  </p>



  <!-- Global Poll Filter -->
  <div class="card">
    <div class="controls">
      <label for="pollFilter">Poll:</label>
      <select id="pollFilter"></select>
      <span id="pollInfo" class="muted"></span>
    </div>
  </div>

  <!-- All Time Summary -->
  <section class="card">
    <h2>All-Time Summary</h2>
    <p>
      GOAT metrics: sort by total weeks ranked, weeks at #1, in the top 3, or in the top 10.
    </p>
    <label for="alltimeSort">Sort By:</label>
    <select id="alltimeSort">
      <option value="total_weeks_ranked" selected>Total Weeks Ranked</option>
      <option value="weeks_at_number_one">#1 Weeks</option>
      <option value="weeks_in_top_3">Top 3 Weeks</option>
      <option value="weeks_in_top_10">Top 10 Weeks</option>
    </select>


    <label for="alltimeCount">Show Top:</label>
    <select id="alltimeCount">
      <option value="5" selected>5</option>
      <option value="10">10</option>
      <option value="20">20</option>
      <option value="50">50</option>
    </select>

    <table id="alltimeTable" class="data-table">
      <thead>
        <tr>
          <th>Rank</th>
          <th>Team</th>
          <th>Total Weeks Ranked</th>
          <th>#1 Weeks</th>
          <th>Top 3 Weeks</th>
          <th>Top 10 Weeks</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
    <div id="alltimeEmpty" class="muted">(no data)</div>
  </section>


  <!-- Overrated Index Explorer -->
  <section id="overrated-explorer" class="card">
    <h2>Overrated Index</h2>
    <p>
      The overrated index compares a team's final ranking vs. preseason ranking.
      A positive value means a team was "overrated", while a negative value implies a team was "underrated".
    </p>
    <div class="row">
      <div class="card sidebar">
        <div class="controls">
          <label for="teamSelect">Teams (max 5):</label>
          <select id="teamSelect" multiple class="multi"></select>
        </div>
        <div class="note">Tip: Hold Ctrl/⌘ to select multiple.</div>

        <h3 style="margin-top:14px;">Team Averages</h3>
        <div id="overratedStatsEmpty" class="muted" style="display:none;">Select teams to see their averages.</div>
        <table id="overratedStatsTable" style="display:none;">
          <thead>
            <tr>
              <th>Team</th>
              <th>Avg Overrated</th>
              <th>Seasons</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>

      <div class="card flex-1">
        <canvas id="overratedChart" height="280"></canvas>
        <div id="overratedEmpty" class="muted" style="display:none;">No series to plot. Select up to 5 teams.</div>
      </div>
    </div>
  </section>

  <!-- Top Overrated Index Table -->
  <section class="card">
  <h2>Most Overrated Teams</h2>
  <p>
    Shows teams with the highest average overrated index across seasons.
    Filter by minimum seasons to avoid one-off outliers.
    You can also see the most underrated teams.
  </p>
  <label for="topMode">Mode:</label>
  <select id="topMode">
    <option value="overrated" selected>Overrated</option>
    <option value="underrated">Underrated</option>
  </select>

  <label for="topOverratedCount">Show Top:</label>
  <select id="topOverratedCount">
    <option value="5" selected>5</option>
    <option value="10">10</option>
    <option value="20">20</option>
    <option value="30">30</option>
  </select>

  <label for="topMinSeasons">Min Seasons:</label>
  <input type="number" id="topMinSeasons" value="3" min="1" style="width:60px;">
  <table id="topOverratedTable" class="data-table">
    <thead>
      <tr>
        <th>Rank</th>
        <th>Team</th>
        <th>Avg Overrated Index</th>
        <th>Seasons Counted</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>
  <div id="topOverratedEmpty">(no data)</div>
</section>

  <!-- Season Ranking Visualizer -->
  <section id="season-visualizer" class="card">
    <h2>Season Ranking Visualizer</h2>
    <p>
      An interactive table, similar to ESPN’s rankings, for exploring the raw weekly data by year and week.
    </p>
    <div class="controls">
      <label for="yearSelect">Year:</label>
      <select id="yearSelect"></select>

      <label for="weekSelect">Week:</label>
      <select id="weekSelect"></select>

      <span id="seasonInfo" class="muted"></span>
    </div>

    <div id="rankingsEmpty" class="muted" style="display:none;">No rankings found for this selection.</div>
    <table id="rankingsTable" style="display:none;">
      <thead>
        <tr>
          <th>Rank</th>
          <th>Team</th>
          <th>Points</th>
          <th>1st Place Votes</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </section>


  <script src="app.js"></script>
</body>
</html>
